#include <bits/stdc++.h>
using namespace std;
using ll = long long;
using pll = pair<ll, ll>;
#define drep(i, cc, n) for (ll i = (cc); i <= (n); ++i)
#define rep(i, n) drep(i, 0, n - 1)
#define all(a) (a).begin(), (a).end()
#define pb push_back
#define fi first
#define se second

const ll MOD = 1000000007;
const ll MOD2 = 998244353;
const ll INF = 1LL << 60;
const ll N_MAX = 2e5;

int main(){
    ll n, m, s;
    cin >> n >> m >> s;

    vector<tuple<ll, ll, ll>> e(m);
    rep(i, m){
        ll u, v, w;
        cin >> u >> v >> w;
        e[i] = {u, v, w};
    }

    vector<ll> dist(n, INF);
    dist[s] = 0;
    rep(i, 2*n){
        rep(j, m){
            ll u = get<0>(e[j]);
            ll v = get<1>(e[j]);
            ll w = get<2>(e[j]);

            if(dist[u] == INF) continue;
            if(dist[u] + w < dist[v]){
                if(n <= i){
                    cout << "NEGATIVE CYCLE" << endl;
                    return 0;
                }
                dist[v] = dist[u]+w;
            }
        }
    }

    rep(i, n){
        if(dist[i] != INF) cout << dist[i] << endl;
        else cout << "INF" << endl;
    }
}
