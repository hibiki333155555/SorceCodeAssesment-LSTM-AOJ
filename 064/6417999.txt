#include <iostream>
#include <vector>
#include <bitset>
using namespace std;

struct Graph
{
    int n;
    std::vector<std::vector<int>> g;
    
    Graph(){}
    
    Graph(int n) : n(n){
        g.resize(n);
    }
    
    void add_edge(int from, int to){
        g[from].push_back(to);
    }
};

struct Matrix
{
    bitset<1100> row[1100], col[1100];
};

Matrix mul(Matrix &A, Matrix &B){
	Matrix res;
	for(int i = 0; i < 1100; i++){
		for(int j = 0; j < 1100; j++){
			if((A.row[i] & B.col[j]).any()){
				res.row[i].set(j);
				res.col[j].set(i);
			}
		}
	}
	return res;
}

Matrix pow(Matrix A, int k){
	Matrix res;
	for(int i = 0; i < 1100; i++){
		res.row[i].set(i);
		res.col[i].set(i);
	}
	while(k){
		if(k & 1) res = mul(res, A);
		A = mul(A, A);
		k >>= 1;
	}
	return res;
}

int main()
{
    int n, d;
    cin >> n >> d;
    Graph g(1100);
    int r = n;
    for(int i = 0; i < n; i++){
        int k;
        cin >> k;
        int v[1002];
        int e[1002];
        int f = 0;
        for(int j = 0; j < k; j++){
            cin >> v[j] >> e[j];
            v[j]--;
            f = max(f, e[j] - 1);
        }
		if(f > 1) g.add_edge(i, r);
        for(int u = r; u < r + f - 1; u++) g.add_edge(u, u + 1);
        for(int j = 0; j < k; j++){
			if(e[j] == 1) g.add_edge(i, v[j]);
			else g.add_edge(r + e[j] - 2, v[j]);
		}
        r += f;
    }
    Matrix A;
    for(int u = 0; u < r; u++){
        for(int v : g.g[u]){
            A.row[u].set(v);
            A.col[v].set(u);
        }
    }
    A = pow(A, d);
    vector<int> ans;
    for(int u = 0; u < n; u++){
        bool f = true;
        for(int v = 0; v < n; v++){
            f &= A.row[v][u];
        }
        if(f) ans.push_back(u);
    }
    cout << ans.size() << endl;
    for(int u : ans) cout << u + 1 << " ";
    cout << endl;
}

