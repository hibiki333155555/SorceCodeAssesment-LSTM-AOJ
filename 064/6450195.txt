#include<bits/stdc++.h>
using namespace std;
using ll=long long;
const ll mod=998244353;
ll modpow(ll x,ll n) {
    ll ret=1;
    x%=mod;
    while(n>0){
        if(n&1)ret*=x;
        x*=x;
        n>>=1;
        ret%=mod;
        x%=mod;
    }
    return ret;
}
int main(){
	ll n;
	cin>>n;
	vector<ll> a(2*n);
	for(int i=1;i<2*n;i++){
		cin>>a[i];
	}
	ll x=n;
	ll y=2*n-1;
	vector<ll> b(2*n,1000000000000000);//最小のインデックス
	vector<ll> c(2*n,0);//最大のインデックス
	for(int i=2*n-1;i>=n;i--){
		b[i]=i;
		c[i]=i;
	}
	for(int i=n-1;i>0;i--){
		b[i]=min(b[i*2],b[i*2+1]);
		c[i]=max(c[i*2],c[i*2+1]);
	}
	for(int i=n-1;i>=1;i--){
		a[i]=min(a[i],a[i*2]+a[i*2+1]);
	}
	ll ans=0;
	vector<ll> v(2*n);
	v[1]=1;
	for(int i=2;i<2*n;i++){
		ll k=(b[i]-x+1)*(y-c[i]+1)%mod;
		v[i]=(mod+k-v[i/2])%mod;
	}
	for(int i=1;i<2*n;i++){
		ans+=a[i]*v[i];
		ans%=mod;
	}
	cout<<ans*modpow(n*(n+1)/2,mod-2)%mod<<endl;
}
