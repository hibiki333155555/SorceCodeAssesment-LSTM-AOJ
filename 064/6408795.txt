#include <iostream>
#include <deque>

using namespace std;
int main(void)
{
    int n;
    cin >> n;
    deque<int> A;
    int d, x, p;
    
    int op;
    for( int i = 0; i < n; i++)
    {
        cin >> op;
        switch( op)
        {
            case 0:
                cin >> d >> x;
                d ? A.push_back(x) : A.push_front(x);
                break;
            case 1:
                cin >> p;
                cout << A[p] << endl;
                break;
            case 2:
                cin >> d;
                d ? A.pop_back() : A.pop_front();
                break;
        }
    }
}

