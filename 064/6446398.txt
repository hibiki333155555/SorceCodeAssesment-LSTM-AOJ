#include <bits/stdc++.h>
using namespace std;

long long m, n;
long long a[1400][1400];
long long b[1400][1400];
long long res = LLONG_MIN;

int main(int argc, char** argv) {
	cin>>m>>n;
	for(long long i = 0; i < m; i++)
	{
		for(long long j = 0; j < n; j++)
		{
			cin>>a[i][j];
		}
	}
	cout<<endl;
	for(long long i = 0; i < m;i++)
	{
		for(long long j = 0; j < n; j++)
		{
			if(a[i][j] == 1) b[i][j] = 0; 
			if(a[i][j] == 0)	b[i][j] = min(min(b[i-1][j],b[i][j-1]),b[i-1][j-1])+1;
			if(b[i][j] > res) res = b[i][j];
		}
	}
	cout<<res;
}
