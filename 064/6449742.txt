#include <bits/stdc++.h>
using namespace std;
using ll = long long;
using vll = vector<ll>;
using vvll = vector<vll>;
using vvvll = vector<vvll>;

using vb = vector<bool>;
using vvb = vector<vb>;
using vvvb = vector<vvb>;

#define all(A) A.begin(),A.end()
#define rep(i, n) for (ll i = 0; i < (ll) (n); i++)

vvll G;
vll A;
ll mod = 998244353;
vector<bool> seen;
vll mi;
vll nu;
vll T(2e6);
ll an = 0;
void dfs(ll n) {
    seen[n] = true;
    ll res = 1;
    ll m = 0;
    bool C = true;
    for (auto v : G[n]) {
        if (seen[v])continue;
        dfs(v);
        C = false;
        m += mi[v];
        res *= (T[nu[v]] - 1);
        res %= mod;
    }
    if (C) {
        nu[n] = 1;
        mi[n] = A[n];
        an += mi[n];
        an %= mod;
    }
    else {
        mi[n] = min(A[n], m);
        an += res * mi[n];
        an %= mod;
    }

}

ll inva(ll N) {
    ll a = N, b = mod, c = 1, d = 0;
    while (b > 0) {
        ll t = a / b;
        a -= t * b;
        swap(a, b);
        c -= t * d;
        swap(c, d);

    }
    c %= mod;
    if (c < 0)c += mod;
    return c;

}

int main() {
    T[0] = 1;
    rep(i, 2e6 - 1) {
        T[i + 1] = (T[i] * 2) % mod;
    }
    ll N;
    cin >> N;
    A.resize(2 * N - 1);
    rep(i, 2*N-1)cin >> A[i];
    G.resize(2 * N - 1);
    rep(i, 2 * N - 1) {
        if (i * 2 + 1 < 2 * N - 1) {
            G[i].push_back(2 * i + 1);
            G[2 * i + 1].push_back(2 * i - i);
        }
        if (i * 2 + 2 < 2 * N - 1) {
            G[i].push_back(2 * i + 2);
            G[2 * i + 2].push_back(2 * i - i);
        }
    }
    nu.resize(2 * N - 1);
    mi.resize(2 * N - 1);
    seen.assign(2*N-1, false);
    dfs(0);
    
    an *= 2;
    an *= inva(N);
    an %= mod;
    an *= inva(N + 1);
    an %= mod;
    cout << an << endl;
}
