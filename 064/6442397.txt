#include <bits/stdc++.h>
using namespace std;
int main()
{
    deque<int>v;
    int q;
    scanf("%d",&q);
    while (q--)
    {
        int a,d,x;
        scanf("%d %d",&a,&d);
        switch (a)
        {
        case 0:
            scanf("%d",&x);
            if (d)
                v.emplace_back(x);
            else
                v.emplace_front(x);
            break;
        case 1:
            printf("%d\n",v.at(d));
            break;
        case 2:
            if (d)
                v.pop_back();
            else
                v.pop_front();
        }
    }
    return 0;
}
