#pragma GCC optimize("Ofast")
#include <bits/stdc++.h>
using namespace std;

#define REP(i,n) for(int i=0;i<(n);i++)
int nxt[30][1000];

int main(){
  ios::sync_with_stdio(false);
  cin.tie(nullptr);

  int n;cin>>n;
  vector<int> v(n);
  REP(i,n)cin>>v[i];
  REP(i,n)nxt[0][i]=i;
  stack<pair<int,int>> sta;
  int q;cin>>q;
  REP(_,q){
    int t;cin>>t;
    if(t==1){
      int x,y;cin>>x>>y;x--;y--;
      swap(nxt[0][x],nxt[0][y]);
      sta.push({x,y});
    }
    if(t==2){
      swap(nxt[0][sta.top().first],nxt[1][sta.top().second]);
      sta.pop();
    }
    if(t==3){
      REP(j,29)REP(i,n)nxt[j+1][i]=nxt[j][nxt[j][i]];
      int k;cin>>k;
      REP(j,30)if((k>>j)&1){
        vector<int> w(n);
        REP(i,n)w[nxt[j][i]]=v[i];
        v=w;
      }
      REP(i,n)cout<<v[i]<<"\n "[i+1<n];
    }
  }
}
