#include<iostream>
#include<queue>
#include<vector>
using namespace std;
static const int INFTY=(1<<21);
static const int WHITE=0;
static const int GRAY=1;
static const int BLACK=2;
static const int MAX=10000;
priority_queue<pair<int,int>,vector<pair<int,int>>,greater<pair<int,int>>> PQ;
int color[MAX],d[MAX],p[MAX],M[MAX][MAX];
void dijkstra(int s){
    for(int i=0;i<MAX;i++){
        color[i]=WHITE;
        d[i]=INFTY;
    }
    d[s]=0;
    PQ.push(make_pair(0,s));
    while(!PQ.empty()){
        int u=PQ.top().second,uc=PQ.top().first;
        PQ.pop();
        color[u]=BLACK;
        if(d[u]<uc)continue;
        for(int v=0;v<MAX;v++){
            if(M[u][v]<INFTY){
                if(color[v]!=BLACK){
                    if(d[u]+M[u][v]<d[v]){
                        d[v]=d[u]+M[u][v];
                        color[v]=GRAY;
                        PQ.push(make_pair(d[v],v));
                    }
                }
            }
        }
    }
}
int main(){
    int n,i,j;
    cin>>n;
    for(i=0;i<MAX;i++)for(j=0;j<MAX;j++)M[i][j]=INFTY;
    for(i=0;i<n;i++){
        int u,k;
        cin>>u>>k;
        for(j=0;j<k;j++){
            int v,c;
            cin>>v>>c;
            M[u][v]=c;
        }
    }
    dijkstra(0);
    for(i=0;i<n;i++){
        cout<<i<<" "<<d[i]<<endl;
    }

    return 0;
}
