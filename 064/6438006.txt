#include <iostream>
#include <vector>
#include <algorithm>
using namespace std;
int main(void){
    
    int N;
    cin >> N;
    
    vector<string> row(N);
    for(int i = 0; i < N; i++){
        cin >> row[i];
    }
    
    
    // 1個時計周りの文字列
    vector<string> row2(N);
    for(int i = 0; i < N; i++){
        for(int j = N-1; j >= 0; j--){
            row2[i] += row[j][i];
        }
    }

    // クエリの処理
    int Q;
    cin >> Q;
    int posi = 0;
    
    for(int i = 0; i < Q; i++){
        
        int r;
        cin >> r;
        
        if(r == 1){
            posi++;
            if(posi == 4) posi = 0;
        }
        else{
            posi--;
            if(posi == -1) posi = 3;
        }
    }
    
    // 結果の出力
    if(posi == 0){
        for(int i = 0; i < N; i++){
            cout << row[i] << endl; 
        }
    }
    if(posi == 1){
        for(int i = 0; i < N; i++){
            cout << row2[i] << endl;
        }
    }
    if(posi == 2){
        for(int i = N-1; i >= 0; i--){
            reverse(row[i].begin(), row[i].end());
            cout << row[i] << endl;
        }
    }
    if(posi == 3){
        for(int i = N-1; i >= 0; i--){
            reverse(row2[i].begin(), row2[i].end());
            cout << row2[i] << endl;
        }
    }    

    
}

