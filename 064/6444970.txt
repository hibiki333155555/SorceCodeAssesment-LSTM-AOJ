#include <bits/stdc++.h>
using namespace std;
string str;
int cur=0;
int spilit_word(int dir=1)
{
    int flag=0;
    for (int i=0;cur+i<str.length()&&cur+i>=0;i+=dir)
        if (flag&&str[cur+i]==' ') return cur+i;
        else flag=1;
    return dir==1?str.length():0;
}
void move(int next)
{
    if (next<0) cur=0;
    else if (next>str.length()) cur=str.length();
    else cur=next;
}
void forward_char() {move(cur+1);}
void backward_char() {move(cur-1);}
void forward_word() {move(spilit_word());}
void backward_word() {move(spilit_word(-1)+1);}
void insert(string x,int len) {str.insert(cur,x);move(cur+len);}
void delete_char() {if (cur!=str.length()) str.erase(cur,1);}
void delete_word() {str.erase(cur,spilit_word()-cur);}
int main()
{
    int k,n;
    scanf("%d",&k);
    //getchar();
    while (k--)
    {
        char tmp[1005]={0},x[1005]={0};
        fgets(tmp,1005,stdin);
        tmp[strlen(tmp)-1]=0;
        str=tmp;
        scanf("%d",&n);
        while (n--)
        {
            scanf("%s%s",tmp,x);
            if (tmp[0]=='f'&&x[0]=='c') forward_char();
            else if (tmp[0]=='f'&&x[0]=='w') forward_word();
            else if (tmp[0]=='b'&&x[0]=='c') backward_char();
            else if (tmp[0]=='b'&&x[0]=='w') backward_word();
            else if (tmp[0]=='d'&&x[0]=='c') delete_char();
            else if (tmp[0]=='d'&&x[0]=='w') delete_word();
            else
            {
                if (x[strlen(x)-1]!='\"') fgets(x+strlen(x),1005,stdin);
                if (x[strlen(x)-1]=='\n') x[strlen(x)-2]='\0';
                else x[strlen(x)-1]='\0';
                insert(x+1,strlen(x+1));
            }
            //printf("%s^%s\n",str.substr(0,cur).c_str(),str.substr(cur).c_str());
        }
        printf("%s^%s\n",str.substr(0,cur).c_str(),str.substr(cur).c_str());
        cur=0;str.clear();getchar();
    }
}
