#include<bits/stdc++.h>
using namespace std;

deque<int>a;

int main(){
	int q;
	cin>>q;
	while(q--){
		int num;
		cin>>num;
		if(num==0){
			int m,n;
			cin>>m>>n;
			if(m==0){
				a.push_front(n);
			}else{
				a.push_back(n);
			}
		}
		if(num==1){
			int s;
			cin>>s;
			cout<<a[s]<<endl;
		}
		if(num==2){
			int p;
			cin>>p;
			if(p==0){
				a.pop_front();
			}else{
				a.pop_back();
			}
		}
	}
	
	
	return 0;
}
