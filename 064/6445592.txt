#include <bits/stdc++.h>
using namespace std;
string str;
int cur=0;
int spilit_word(int dir=1)
{
    int flag=0;
    for (int i=0;cur+i>=0&&cur+i<=str.length();i+=dir)
        if (flag&&str[cur+i]==' ') return cur+i;
        else if (str[cur+i]!=' ') flag=1;
    return -1;
}
void move(int next)
{
    if (next<0) cur=0;
    else if (next>str.length()) cur=str.length();
    else cur=next;
}
void forward_char() {move(cur+1);}
void backward_char() {move(cur-1);}
void forward_word() {if (~spilit_word()) move(spilit_word()); else move((int)str.length());}
void backward_word() {if (~spilit_word()) move(spilit_word(-1)+1); else move(0);}
void insert(string x,int len) {str.insert(cur,x);move(cur+len);}
void delete_char() {if (cur!=str.length()) str.erase(cur,1);}
void delete_word() {if (~spilit_word()) str.erase(cur,spilit_word()-cur);}
int main()
{
    int k,n;
    scanf("%d",&k);
    getchar();
    while (k--)
    {
        char tmp[1010]={0},x[1010]={0};
        fgets(tmp,1005,stdin);
        tmp[strlen(tmp)-1]=0;
        str=tmp;
        scanf("%d",&n);
        while (n--)
        {
            scanf("%s",tmp);
            fgets(x,1010,stdin);
            if (tmp[0]=='f'&&x[1]=='c') forward_char();
            else if (tmp[0]=='f'&&x[1]=='w') forward_word();
            else if (tmp[0]=='b'&&x[1]=='c') backward_char();
            else if (tmp[0]=='b'&&x[1]=='w') backward_word();
            else if (tmp[0]=='d'&&x[1]=='c') delete_char();
            else if (tmp[0]=='d'&&x[1]=='w') delete_word();
            else
            {
                x[strlen(x)-2]='\0';
                insert(x+2,strlen(x+2));
            }
            //printf("\"%s^%s\"\n\n",str.substr(0,cur).c_str(),str.substr(cur).c_str());
        }
        printf("%s^%s\n",str.substr(0,cur).c_str(),str.substr(cur).c_str());
        cur=0;str.clear();
    }
}
