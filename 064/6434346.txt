#include<bits/stdc++.h>
using namespace std;

int main(){
    int N,Q;
    cin >> N;
    vector<int> A(N+2);
    for(int i=1;i<N+1;i++){
        cin >> A.at(i);
    }
    A.at(0) = 0;
    A.at(N+1) = 1000000000;
    vector<int> posi(N+2);
    int diff = 0;
    for(int i=1;i<N+1;i++){
        if(A.at(i)>A.at(i+1)){
            posi.at(i)=1;
            diff++;
        }else{
            posi.at(i) = 0;
        }
    }
    cin >> Q;
    vector<int> x(Q),y(Q);
    for(int i=0;i<Q;i++){
        cin >> x.at(i) >> y.at(i);
    }
    for(int i=0;i<Q;i++){
        if(diff==0){
            cout << i << endl;
            return 0;
        }
        swap(A.at(x.at(i)),A.at(y.at(i)));
        for(int j=0;j<2;j++){
            if(posi.at(x.at(i)-j)==1){
                posi.at(x.at(i)-j) = 0;
                diff--;
            }
            if(posi.at(y.at(i)-j)==1){
                posi.at(y.at(i)-j) = 0;
                diff--;
            }
        }
        if(A.at(x.at(i)-1)>A.at(x.at(i))){
            posi.at(x.at(i)-1) = 1;
            diff++;
        }if(A.at(x.at(i))>A.at(x.at(i)+1)){
            posi.at(x.at(i)) = 1;
            diff++;
        }
        if(A.at(y.at(i)-1)>A.at(y.at(i))){
            posi.at(y.at(i)-1) = 1;
            diff++;
        }
        if(A.at(y.at(i))>A.at(y.at(i)+1)){
            posi.at(y.at(i)) = 1;
            diff++;
        }
    }
    if(diff==0){
        cout << Q << endl;
    }else{
        cout << -1 << endl;
    }

    return 0;
}
