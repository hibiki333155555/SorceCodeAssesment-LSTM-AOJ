#include<stdio.h>
#include<stdbool.h>
#include<stdlib.h>

typedef struct Node{
  int key;
  struct Node *left, *right, *parent;
}Node;

Node NIL;

Node *treeMinimum(Node *x){
  while(x->left != &NIL) x = x->left;
  return x;
}

Node *createNode(int k){
  Node *x = (Node *)malloc(sizeof(Node));
  x->key = k;
  x->left = &NIL;
  x->right = &NIL;
  return x;
}

Node *treeDelete(Node *root, int k){
  if(root == &NIL) return root;
  if(root->key > k) root->left = treeDelete(root->left, k);
  else if(root->key < k) root->right = treeDelete(root->right, k);
  else{
    if(root->right == &NIL) return root->left;
    else if(root->left == &NIL) return root->right;
    else{
      Node *temp = treeMinimum(root->right);
      root->key = temp->key;
      root->right = treeDelete(root->right, temp->key);
    }
  }
  return root;
}

Node *insert(Node *root, int k){
  if(root == &NIL) return createNode(k);
  if(root->key > k) root->left = insert(root->left, k);
  else if(root->key < k) root->right = insert(root->right, k);
  return root;
}

Node *find(Node *root, int k){
  while(root != &NIL && k != root->key){
    if(root->key > k) root = root->left;
    else root = root->right;
  }
  return root;
}

void preorder(Node *root){
  if(root == &NIL) return;
  printf(" %d", root->key);
  preorder(root->left);
  preorder(root->right);
}

void inorder(Node *root){
  if(root == &NIL) return;
  inorder(root->left);
  printf(" %d", root->key);
  inorder(root->right);
}

int main()
{
  int m;
  int k;
  char com[20];

  Node *root;
  root = &NIL;

  scanf("%d", &m);
  for(int i = 0; i < m; i++ ){
    scanf("%s", com);
    if(com[0] == 'i'){
      scanf("%d", &k);
      root = insert(root, k);
    }else if(com[0] == 'f'){
      scanf("%d", &k);
      if(find(root, k) == &NIL) printf("no\n");
      else printf("yes\n");
    }else if(com[0] == 'd'){
      scanf("%d", &k);
      root = treeDelete(root, k);
    }else{
      inorder(root);
      printf("\n");
      preorder(root);
      printf("\n");
    }
  }
  return 0;
}
